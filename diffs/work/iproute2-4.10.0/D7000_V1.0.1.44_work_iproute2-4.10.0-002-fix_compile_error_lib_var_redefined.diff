diff -urN work/iproute2-4.10.0/ip/ipmonitor.c work/iproute2-4.10.0/ip/ipmonitor.c
--- work/iproute2-4.10.0/ip/ipmonitor.c	2016-12-13 00:07:42.000000000 +0100
+++ work/iproute2-4.10.0/ip/ipmonitor.c	2017-02-14 22:37:24.435931529 +0100
@@ -26,7 +26,7 @@
 
 static void usage(void) __attribute__((noreturn));
 int prefix_banner;
-int listen_all_nsid;
+int listen_nsid_all;
 
 static void usage(void)
 {
@@ -42,7 +42,7 @@
 	if (timestamp)
 		print_timestamp(fp);
 
-	if (listen_all_nsid) {
+	if (listen_nsid_all) {
 		if (ctrl == NULL || ctrl->nsid < 0)
 			fprintf(fp, "[nsid current]");
 		else
@@ -215,7 +215,7 @@
 		} else if (strcmp(*argv, "all") == 0) {
 			prefix_banner = 1;
 		} else if (matches(*argv, "all-nsid") == 0) {
-			listen_all_nsid = 1;
+			listen_nsid_all = 1;
 		} else if (matches(*argv, "help") == 0) {
 			usage();
 		} else if (strcmp(*argv, "dev") == 0) {
@@ -297,7 +297,7 @@
 
 	if (rtnl_open(&rth, groups) < 0)
 		exit(1);
-	if (listen_all_nsid && rtnl_listen_all_nsid(&rth) < 0)
+	if (listen_nsid_all && rtnl_listen_all_nsid(&rth) < 0)
 		exit(1);
 
 	ll_init_map(&rth);
diff -urN work/iproute2-4.10.0/ip/ipxfrm.c work/iproute2-4.10.0/ip/ipxfrm.c
--- work/iproute2-4.10.0/ip/ipxfrm.c	2016-12-13 00:07:42.000000000 +0100
+++ work/iproute2-4.10.0/ip/ipxfrm.c	2017-02-14 22:34:04.893370913 +0100
@@ -52,7 +52,7 @@
 		} \
 	} while (0);
 
-struct xfrm_filter filter;
+struct xfrm_filter frm_filter;
 
 static void usage(void) __attribute__((noreturn));
 
@@ -1071,7 +1071,7 @@
 
 			memcpy(saddr, &src.data, sizeof(*saddr));
 
-			filter.id_src_mask = src.bitlen;
+			frm_filter.id_src_mask = src.bitlen;
 
 		} else if (strcmp(*argv, "dst") == 0) {
 			NEXT_ARG();
@@ -1084,7 +1084,7 @@
 
 			memcpy(&id->daddr, &dst.data, sizeof(id->daddr));
 
-			filter.id_dst_mask = dst.bitlen;
+			frm_filter.id_dst_mask = dst.bitlen;
 
 		} else if (strcmp(*argv, "proto") == 0) {
 			int ret;
@@ -1097,14 +1097,14 @@
 
 			id->proto = (__u8)ret;
 
-			filter.id_proto_mask = XFRM_FILTER_MASK_FULL;
+			frm_filter.id_proto_mask = XFRM_FILTER_MASK_FULL;
 
 		} else if (strcmp(*argv, "spi") == 0) {
 			NEXT_ARG();
 			if (get_be32(&id->spi, *argv, 0))
 				invarg("SPI value is invalid", *argv);
 
-			filter.id_spi_mask = XFRM_FILTER_MASK_FULL;
+			frm_filter.id_spi_mask = XFRM_FILTER_MASK_FULL;
 
 		} else {
 			PREV_ARG(); /* back track */
@@ -1231,7 +1231,7 @@
 			}
 			sel->proto = upspec;
 
-			filter.upspec_proto_mask = XFRM_FILTER_MASK_FULL;
+			frm_filter.upspec_proto_mask = XFRM_FILTER_MASK_FULL;
 
 		} else if (strcmp(*argv, "sport") == 0) {
 			sportp = *argv;
@@ -1243,7 +1243,7 @@
 			if (sel->sport)
 				sel->sport_mask = ~((__u16)0);
 
-			filter.upspec_sport_mask = XFRM_FILTER_MASK_FULL;
+			frm_filter.upspec_sport_mask = XFRM_FILTER_MASK_FULL;
 
 		} else if (strcmp(*argv, "dport") == 0) {
 			dportp = *argv;
@@ -1255,7 +1255,7 @@
 			if (sel->dport)
 				sel->dport_mask = ~((__u16)0);
 
-			filter.upspec_dport_mask = XFRM_FILTER_MASK_FULL;
+			frm_filter.upspec_dport_mask = XFRM_FILTER_MASK_FULL;
 
 		} else if (strcmp(*argv, "type") == 0) {
 			typep = *argv;
@@ -1268,7 +1268,7 @@
 			sel->sport = htons(sel->sport);
 			sel->sport_mask = ~((__u16)0);
 
-			filter.upspec_sport_mask = XFRM_FILTER_MASK_FULL;
+			frm_filter.upspec_sport_mask = XFRM_FILTER_MASK_FULL;
 
 
 		} else if (strcmp(*argv, "code") == 0) {
@@ -1282,7 +1282,7 @@
 			sel->dport = htons(sel->dport);
 			sel->dport_mask = ~((__u16)0);
 
-			filter.upspec_dport_mask = XFRM_FILTER_MASK_FULL;
+			frm_filter.upspec_dport_mask = XFRM_FILTER_MASK_FULL;
 
 		} else if (strcmp(*argv, "key") == 0) {
 			unsigned int uval;
@@ -1305,7 +1305,7 @@
 			sel->sport_mask = ~((__u16)0);
 			sel->dport_mask = ~((__u16)0);
 
-			filter.upspec_dport_mask = XFRM_FILTER_MASK_FULL;
+			frm_filter.upspec_dport_mask = XFRM_FILTER_MASK_FULL;
 
 		} else {
 			PREV_ARG(); /* back track */
@@ -1378,7 +1378,7 @@
 			memcpy(&sel->saddr, &src.data, sizeof(sel->saddr));
 			sel->prefixlen_s = src.bitlen;
 
-			filter.sel_src_mask = src.bitlen;
+			frm_filter.sel_src_mask = src.bitlen;
 
 		} else if (strcmp(*argv, "dst") == 0) {
 			NEXT_ARG();
@@ -1391,7 +1391,7 @@
 			memcpy(&sel->daddr, &dst.data, sizeof(sel->daddr));
 			sel->prefixlen_d = dst.bitlen;
 
-			filter.sel_dst_mask = dst.bitlen;
+			frm_filter.sel_dst_mask = dst.bitlen;
 
 		} else if (strcmp(*argv, "dev") == 0) {
 			int ifindex;
@@ -1407,7 +1407,7 @@
 			}
 			sel->ifindex = ifindex;
 
-			filter.sel_dev_mask = XFRM_FILTER_MASK_FULL;
+			frm_filter.sel_dev_mask = XFRM_FILTER_MASK_FULL;
 
 		} else {
 			if (upspecp) {
@@ -1495,7 +1495,7 @@
 
 int do_xfrm(int argc, char **argv)
 {
-	memset(&filter, 0, sizeof(filter));
+	memset(&frm_filter, 0, sizeof(frm_filter));
 
 	if (argc < 1)
 		usage();
diff -urN work/iproute2-4.10.0/lib/bpf.c work/iproute2-4.10.0/lib/bpf.c
--- work/iproute2-4.10.0/lib/bpf.c	2016-12-13 00:07:42.000000000 +0100
+++ work/iproute2-4.10.0/lib/bpf.c	2017-02-15 23:42:50.657173101 +0100
@@ -38,6 +38,7 @@
 #include <sys/resource.h>
 
 #include <arpa/inet.h>
+#include <linux/fs.h>
 
 #include "utils.h"
 
